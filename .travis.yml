language: Objective-C
osx_image: xcode8
env:
  - NSUnbufferedIO=YES
before_install:
  - rvm get head
  - ./scripts/travis/prep_keychain.sh
install:
  - bundle install --with ci --without=documentation --path ../travis_bundle_dir
  - bundle exec pod install
script: xcodebuild -workspace ShapeSwift.xcworkspace -scheme ShapeSwift -sdk iphonesimulator -destination 'platform=iOS Simulator,name=iPhone SE' -enableCodeCoverage YES test

after_failure:
  - sleep 10

after_success:
  - bundle exec slather
  - bash <(curl -s https://codecov.io/bash) -f tmp/cobertura.xml
